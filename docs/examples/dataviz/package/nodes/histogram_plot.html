<!DOCTYPE html>
<html>

<!-- the head allows this page to be loaded standalone to test the layout, but is ignored by skadi -->
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">

    <link href="//fonts.googleapis.com/css?family=Raleway:400,300,600" rel="stylesheet" type="text/css">

    <link href="https://visualtopology.github.io/exo/versions/latest/exo.css" rel="stylesheet" type="text/css">
    <link href="https://visualtopology.github.io/exo/versions/latest/exo-icons.css" rel="stylesheet" type="text/css">
    <script src="https://visualtopology.github.io/exo/versions/latest/exo.js" type="text/javascript"></script>

    <script src="https://cdn.jsdelivr.net/npm/vega@5.22.1"></script>
    <script src="https://cdn.jsdelivr.net/npm/vega-lite@5.6.1"></script>
    <script src="https://cdn.jsdelivr.net/npm/vega-embed@6.21.2"></script>

    <script src="../../../../versions/latest/skadi-ui.js" type="text/javascript"></script>
    <script>
        skadiui.set_message_handler((msg) => {
                let vizdiv = document.getElementById("vizdiv");
                if (msg.dataset) {
                    let spec = {
                        "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
                        "data": { "format": {"type": "csv"}, "values": msg.dataset },
                        "mark": "bar",
                        "width": msg.width - 200,
                        "height": msg.height - 300,
                        "encoding": {
                            "x": {
                                "field": msg.x_col
                            },
                            "y": {"aggregate": "count"}
                        }
                    }
                    if (msg.use_custom_settings) {
                        spec["encoding"]["x"]["bin"] = {
                            "step": msg.custom_band_width,
                            "anchor": msg.custom_band_anchor
                        }
                    }
                    if (msg.h_col) {
                        spec["encoding"]["color"] = {"field":msg.h_col, "type": "nominal"};
                    }
                    vegaEmbed(vizdiv, spec, {"actions": false});
                } else {
                    vizdiv.innerHTML = "";
                }
            });
    </script>
</head>

<body>

<div class="exo-row">
    <div class="exo-2-cell">
        <exo-select id="x_axis" label="X-Axis">
        </exo-select>
    </div>
    <div class="exo-2-cell">
        <exo-select id="hue" label="Hue">
        </exo-select>
    </div>
</div>
<div class="exo-row">
    <div class="exo-tree" role="tree">
        <div is="exo-tree" label="More Settings...">
            <div class="exo-row">
                <div class="exo-2-cell">
                    <exo-checkbox id="use_custom" label="Manual" value="false">
                    </exo-checkbox>
                </div>
                <div class="exo-2-cell">
                    <exo-number step="0.1" id="custom_band_anchor" value="0" label="Band Start">
                    </exo-number>
                </div>
                <div class="exo-2-cell">
                    <exo-number step="0.01" id="custom_band_width" value="1" label="Band Width">
                    </exo-number>
                </div>
            </div>

        </div>
    </div>
</div>
<div id="vizdiv">
</div>
</body>
</html>
